# IEEE SusTech Student Branch - Project Team - Back End

Here I will upload my progress on learning Django, following this [tutorial](https://docs.djangoproject.com/en/4.0/intro/tutorial01/) on a set schedule . I am using Windows 10, so all code written below is specifically windows-compatible

## Installation

Install [Python](https://python.org)

Use the package manager [pip](https://pip.pypa.io/en/stable/) to install [Django](https://docs.djangoproject.com/en/4.0/intro/install/)

```bash
py -m pip install Django
```

Go to a directory you want your project files to reside in.

Create a [virtual environment](https://docs.python.org/3/library/venv.html)

```bash
py -m venv NameOfVirtualEnvironment
```
Install Django again within the virtual environment, and upgrade pip if you need to

## Week One - The MVT design pattern and my first view:
### polls/urls.py 
```python
from django.urls import path
from . import views

urlpatterns = [
    path('', views.index, name='home'),
]
```
### polls/views.py
```python
from django.shortcuts import render
from django.http import HttpResponse

def index(req):
    return HttpResponse('Hello Django, this is the index page of the polls app')
```
### mysite/urls.py
```python
from django.contrib import admin
from django.urls import path, include  # Imported the include function

urlpatterns = [
    path('admin/', admin.site.urls),
    path('polls', include('polls.urls')),
    # Used the include function here to route to polls
]
```
## Week Two - Database setup and working with models
First and foremost, run the migrate command to start working with the database (in this case the already existing db.sqlite3)
```bash
py manage.py migrate
```
Connect your app to the main backend, so I added the polls app to mysite.
### mysite/settings.py
```python
# Application definition

INSTALLED_APPS = [
    'polls.apps.PollsConfig',  # added
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
]
```
Now you can customize your models, to create database tables  with a specific underlying logic and model

### polls/models.py
```python
import datetime

from django.db import models
from django.utils import timezone


class Question(models.Model):
    q_txt = models.CharField(max_length=200)
    pub_date = models.DateTimeField('date published')
    # Human friendly name ^

    def __str__(self):
        return self.q_txt

    def was_published(self):
        return self.pub_date >= timezone.now() - datetime.timedelta(days=1)


class Choice(models.Model):
    q = models.ForeignKey(Question, on_delete=models.CASCADE)
    choice_txt = models.CharField(max_length=200)
    votes = models.IntegerField(default=0)

    def __str__(self):
        return self.choice_txt

# Create your models here.
```
### polls/admin.py
```python
from django.contrib import admin
from .models import Question

admin.site.register(Question)

# Register your models here.
```
Then run the following on the terminal
```bash
py manage.py makemigrations polls
```
This ^ will genereate a new folder within the polls directory, and create a python file called 0001_initial.py
The fill will look something like this
### polls/migrations/0001_initial.py
```python
# Generated by Django 4.0.4 on 2022-04-14 17:36

from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.CreateModel(
            name='Question',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('q_txt', models.CharField(max_length=200)),
                ('pub_date', models.DateTimeField(verbose_name='date published')),
            ],
        ),
        migrations.CreateModel(
            name='Choice',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('choice_txt', models.CharField(max_length=200)),
                ('votes', models.IntegerField(default=0)),
                ('q', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='polls.question')),
            ],
        ),
    ]

```
From here, you could immediately run the migrate command and configure your database to accommodate the change in your models
However, if you were interested in seeing what SQL would run on the database, you could run sqlmigrate
```bash
py manage.py sqlmigrate polls 0001
```
This will show you some SQL in the terminal that looks something like this (just less formatted)
```sql
BEGIN;
--
-- Create model Question
--
CREATE TABLE "polls_question" (
    "id" serial NOT NULL PRIMARY KEY,
    "question_text" varchar(200) NOT NULL,
    "pub_date" timestamp with time zone NOT NULL
);
--
-- Create model Choice
--
CREATE TABLE "polls_choice" (
    "id" serial NOT NULL PRIMARY KEY,
    "choice_text" varchar(200) NOT NULL,
    "votes" integer NOT NULL,
    "question_id" integer NOT NULL
);
ALTER TABLE "polls_choice"
  ADD CONSTRAINT "polls_choice_question_id_c5b4b260_fk_polls_question_id"
    FOREIGN KEY ("question_id")
    REFERENCES "polls_question" ("id")
    DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "polls_choice_question_id_c5b4b260" ON "polls_choice" ("question_id");

COMMIT;
```
Then you can migrate if you think this looks good, and either interact with the API using the shell or the GUI
For using the python shell, you run
```bash
py manage.py shell
```
To use the GUI, you use the [django admin](https://docs.djangoproject.com/en/4.0/intro/tutorial02/#introducing-the-django-admin)
